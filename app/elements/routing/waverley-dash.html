
<dom-module id="waverley-dash">
  <template>
    <style>

      neon-animated-pages {
        overflow-x: hidden;
        width: 100%;
        display: block;
        height: 1000px;
      }

      neon-animatable {
        padding: 32px;
      }

      neon-animatable > * {
        width: 100%;
      }



    </style>
    <style include="shared-styles"></style>
    <style include="iron-flex iron-flex-alignment"></style>

    <waverley-dash-data posts="{{posts}}" location="{{location}}" modded-location="{{moddedLocation}}"></waverley-dash-data>

    <carbon-route route="{{route}}" pattern="/:tabName" data="{{data}}"></carbon-route>
    <paper-scroll-header-panel>
      <div class="paper-header">
        <paper-toolbar>
          <div class="app-name">
            <span class="waverley">Waverley</span><span class="dash">Dash</span>
          </div>
          <span class="flex"></span>
          <paper-icon-button icon="more-vert"></paper-icon-button>
        </paper-toolbar>
        <paper-tabs selected='{{data.tabName}}' attr-for-selected="name">
          <paper-tab name='overview'>OVERVIEW</paper-tab>
          <paper-tab name='blog'>BLOG</paper-tab>
        </paper-tabs>
      </div>

      <div>
        <neon-animated-pages id='animatedPages'
                             selected='{{selectedPage}}'
                             entry-animation='{{entryAnimation}}'
                             exit-animation='{{exitAnimation}}'
                             attr-for-selected="name">

          <neon-animatable class="vertical layout center" name='overview'>
            <overview-page views="56" comments="28"></overview-page>
          </neon-animatable>

          <neon-animatable class="vertical layout center" name='blog'>
            <blog-editor-page posts="{{posts}}"></blog-editor-page>
          </neon-animatable>

        </neon-animated-pages>
      </div>
    </paper-scroll-header-panel>



  </template>
  <script>
    window.addEventListener('WebComponentsReady', function() {
      Polymer({
        is: 'waverley-dash',
        properties: {
          route: {
            type: Object,
            notify: true
          }
        },
        observers: [
          'pageChanged(data.tabName)'
        ],
        pageChanged: function() {
          // We assign to selectedPage here rather than just binding
          // the selected property of neon-animated-pages to selectedPage
          // so that we can first figure out which animation to use in the
          // transition.
          var transitioningFrom = this.$.animatedPages.selected;
          var transitioningTo = this.data.tabName;
          var pagesInOrder = this.$.animatedPages.items.map(
            function(x) {return x.getAttribute('name')});
          if (pagesInOrder.indexOf(transitioningFrom) > pagesInOrder.indexOf(transitioningTo)) {
            this.entryAnimation = 'slide-from-right-animation';
            this.exitAnimation = 'slide-left-animation';
          } else {
            this.entryAnimation = 'slide-from-left-animation';
            this.exitAnimation = 'slide-right-animation';
          }

          this.selectedPage = this.data.tabName;

          window.scroll(0,0);
          // slide-from-left-animation
        }
      });
    });
  </script>
</dom-module>
